# å¶åƒå¤§å¸ˆé—ªè€€è‰²å½© - ä»£ç ä¼˜åŒ–å»ºè®®

**ç”Ÿæˆæ—¥æœŸï¼š** 2025-10-26  
**æ£€æŸ¥èŒƒå›´ï¼š** `src/å¶åƒå¤§å¸ˆé—ªè€€è‰²å½©/` å…¨éƒ¨æ–‡ä»¶  
**Linter çŠ¶æ€ï¼š** âœ… æ— é”™è¯¯

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶              | è¡Œæ•°  | çŠ¶æ€   | è¯´æ˜                     |
| ----------------- | ----- | ------ | ------------------------ |
| `app.vue`         | 3,832 | âš ï¸ åå¤§ | ä¸»ç»„ä»¶ï¼ŒåŒ…å«æ‰€æœ‰UIå’Œé€»è¾‘ |
| `songs.ts`        | 1,679 | âœ… è‰¯å¥½ | æ­Œæ›²æ•°æ®ï¼Œç»“æ„æ¸…æ™°       |
| `music-player.ts` | ~600  | âœ… è‰¯å¥½ | éŸ³ä¹æ’­æ”¾é€»è¾‘ï¼Œå·²åˆ†ç¦»     |
| `index.ts`        | 13    | âœ… ä¼˜ç§€ | å…¥å£æ–‡ä»¶ï¼Œç®€æ´           |
| `index.html`      | -     | âœ… è‰¯å¥½ | HTMLæ¨¡æ¿                 |

---

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### 1. app.vue ç»„ä»¶æ‹†åˆ†ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

**ç°çŠ¶ï¼š**
- `app.vue` æœ‰ 3,832 è¡Œï¼ŒåŒ…å«ä¸»ç•Œé¢ã€è§’è‰²é€‰æ‹©ã€éŸ³ä¹æ’­æ”¾å™¨ç­‰æ‰€æœ‰åŠŸèƒ½
- è™½ç„¶ç»“æ„æ¸…æ™°ï¼Œä½†å•æ–‡ä»¶è¿‡å¤§ï¼Œä¸åˆ©äºç»´æŠ¤

**å»ºè®®æ–¹æ¡ˆï¼š**

#### æ–¹æ¡ˆ Aï¼šæœ€å°æ‹†åˆ†ï¼ˆæ¨èï¼‰
ä¿æŒå½“å‰ç¨³å®šæ€§ï¼Œä»…æ‹†åˆ†ç‹¬ç«‹åŠŸèƒ½æ¨¡å—ï¼š

```
src/å¶åƒå¤§å¸ˆé—ªè€€è‰²å½©/
â”œâ”€â”€ app.vue                    (ä¸»å¸ƒå±€ + çŠ¶æ€ç®¡ç†ï¼Œ~800è¡Œ)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ CharacterGallery.vue   (è§’è‰²é€‰æ‹©ç•Œé¢ï¼Œ~500è¡Œ)
â”‚   â”œâ”€â”€ MusicPlayer.vue        (éŸ³ä¹æ’­æ”¾å™¨ç•Œé¢ï¼Œ~800è¡Œ)
â”‚   â”œâ”€â”€ IdolDetails.vue        (å¶åƒè¯¦æƒ…ç•Œé¢ï¼Œ~400è¡Œ)
â”‚   â””â”€â”€ shared/
â”‚       â”œâ”€â”€ ResourceDisplay.vue (èµ„æºæ˜¾ç¤º)
â”‚       â””â”€â”€ ProducerCard.vue   (åˆ¶ä½œäººä¿¡æ¯å¡)
â”œâ”€â”€ music-player.ts
â”œâ”€â”€ songs.ts
â”œâ”€â”€ index.ts
â””â”€â”€ index.html
```

**ä¼˜ç‚¹ï¼š**
- é€»è¾‘æ¸…æ™°ï¼Œæ˜“äºæŸ¥æ‰¾
- ç»„ä»¶å¯å¤ç”¨
- ä¾¿äºå›¢é˜Ÿåä½œ

**ç¼ºç‚¹ï¼š**
- éœ€è¦é‡æ„ç°æœ‰ä»£ç 
- Props ä¼ é€’å¯èƒ½å¢åŠ å¤æ‚åº¦

---

#### æ–¹æ¡ˆ Bï¼šä¿æŒç°çŠ¶ï¼ˆçŸ­æœŸæ¨èï¼‰
æš‚ä¸æ‹†åˆ†ï¼Œç­‰åŠŸèƒ½ç¨³å®šåå†ä¼˜åŒ–ï¼š

**ç†ç”±ï¼š**
1. âœ… **å½“å‰ä»£ç å·²ç»ç»“æ„åŒ–è‰¯å¥½**
   - Template éƒ¨åˆ†æ¸…æ™°åˆ†å±‚
   - Script éƒ¨åˆ†å‡½æ•°èŒè´£æ˜ç¡®
   - Style éƒ¨åˆ†ç”¨ SCSS åµŒå¥—ç»„ç»‡
   
2. âœ… **Linter æ— é”™è¯¯**
   - ä»£ç è´¨é‡è‰¯å¥½
   - æ— æ˜æ˜¾æ€§èƒ½é—®é¢˜

3. âœ… **é¡¹ç›®ä»åœ¨å¿«é€Ÿè¿­ä»£**
   - è¿‡æ—©æ‹†åˆ†å¯èƒ½é¢‘ç¹ä¿®æ”¹
   - å¢åŠ å¼€å‘æˆæœ¬

**å»ºè®®æ—¶æœºï¼š**
- åŠŸèƒ½åŸºæœ¬ç¨³å®šåï¼ˆç¬¬äºŒé˜¶æ®µå¼€å§‹æ—¶ï¼‰
- éœ€è¦å¤šäººåä½œæ—¶
- å‘ç°æ˜æ˜¾æ€§èƒ½ç“¶é¢ˆæ—¶

---

### 2. ä»£ç è´¨é‡ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰

#### 2.1 ç±»å‹å®‰å…¨åŠ å¼º

**å½“å‰ï¼š** éƒ¨åˆ†åœ°æ–¹ä½¿ç”¨ `any` ç±»å‹
```typescript
// music-player.ts
catch (error: any) {
  console.error('æ’­æ”¾å¤±è´¥:', error);
}
```

**å»ºè®®ï¼š**
```typescript
catch (error) {
  if (error instanceof Error) {
    console.error('æ’­æ”¾å¤±è´¥:', error.message);
  }
}
```

---

#### 2.2 é­”æœ¯æ•°å­—æå–

**å½“å‰ï¼š** ä»£ç ä¸­æœ‰ç¡¬ç¼–ç æ•°å­—
```typescript
setTimeout(() => {
  scrollToSong(index);
}, 50); // ä¸ºä»€ä¹ˆæ˜¯ 50ï¼Ÿ
```

**å»ºè®®ï¼š**
```typescript
const SCROLL_DELAY_MS = 50; // ç­‰å¾…DOMæ¸²æŸ“å®Œæˆ
setTimeout(() => {
  scrollToSong(index);
}, SCROLL_DELAY_MS);
```

---

#### 2.3 é”™è¯¯è¾¹ç•Œå¤„ç†

**å»ºè®®æ·»åŠ ï¼š**
```vue
<template>
  <ErrorBoundary>
    <div class="idol-master-container">
      <!-- ç°æœ‰å†…å®¹ -->
    </div>
  </ErrorBoundary>
</template>
```

Vue 3 å¯ä»¥ä½¿ç”¨ `onErrorCaptured` é’©å­ï¼š
```typescript
onErrorCaptured((err, instance, info) => {
  console.error('ç»„ä»¶é”™è¯¯:', err, info);
  toastr.error('å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢', 'é”™è¯¯');
  return false;
});
```

---

### 3. æ€§èƒ½ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰

#### 3.1 å›¾ç‰‡æ‡’åŠ è½½

**å½“å‰ï¼š** æ‰€æœ‰å›¾ç‰‡ç«‹å³åŠ è½½
```vue
<img :src="song.albumCover" />
```

**å»ºè®®ï¼š**
```vue
<img :src="song.albumCover" loading="lazy" />
```

æˆ–ä½¿ç”¨ Intersection Observerï¼š
```typescript
const lazyLoadImage = (img: HTMLImageElement) => {
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        img.src = img.dataset.src!;
        observer.unobserve(img);
      }
    });
  });
  observer.observe(img);
};
```

---

#### 3.2 é˜²æŠ–/èŠ‚æµ

**å½“å‰ï¼š** æ»šåŠ¨äº‹ä»¶å¯èƒ½é¢‘ç¹è§¦å‘
```typescript
songListRef.value.addEventListener('scroll', updateScroll);
```

**å»ºè®®ï¼š**
```typescript
import { useDebounceFn } from '@vueuse/core';

const debouncedUpdateScroll = useDebounceFn(() => {
  updateScroll();
}, 100);

songListRef.value.addEventListener('scroll', debouncedUpdateScroll);
```

---

#### 3.3 å¤§åˆ—è¡¨è™šæ‹ŸåŒ–

**å½“å‰çŠ¶å†µï¼š**
- 133 é¦–æ­Œæ›²å…¨éƒ¨æ¸²æŸ“
- å¯¹äºå½“å‰æ•°é‡ï¼Œæ€§èƒ½å½±å“ä¸å¤§

**å»ºè®®ï¼š**
- æš‚ä¸éœ€è¦è™šæ‹Ÿæ»šåŠ¨
- å¦‚æœæ­Œæ›²æ•°é‡ > 500ï¼Œè€ƒè™‘ä½¿ç”¨ `vue-virtual-scroller`

---

### 4. ä»£ç ç»„ç»‡ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰

#### 4.1 å¸¸é‡æå–

**å»ºè®®åˆ›å»ºï¼š** `src/å¶åƒå¤§å¸ˆé—ªè€€è‰²å½©/constants.ts`
```typescript
export const CDN_BASE = 'https://cdn.jsdelivr.net/gh/2426269/shinycolors-assets@main';
export const AUDIO_BASE = 'https://github.com/2426269/shinycolors-assets/releases/download/music-v1.0';

export const UNITS = [
  'Illumination STARS',
  'L\'Antica',
  'ALSTROEMERIA',
  'Straylight',
  'noctchill',
  'æ”¾å­¦åCLIMAX GIRLS',
  'SHHis',
  'CoMETIK',
] as const;

export type Unit = typeof UNITS[number];

export const SCROLL_DELAY_MS = 50;
export const TOAST_DURATION_MS = 2000;
```

---

#### 4.2 å·¥å…·å‡½æ•°æå–

**å»ºè®®åˆ›å»ºï¼š** `src/å¶åƒå¤§å¸ˆé—ªè€€è‰²å½©/utils.ts`
```typescript
export const formatDuration = (seconds: number): string => {
  const mins = Math.floor(seconds / 60);
  const secs = Math.floor(seconds % 60);
  return `${mins}:${secs.toString().padStart(2, '0')}`;
};

export const getCharacterImageUrl = (unit: string, name: string): string => {
  return `${CDN_BASE}/äººç‰©ç«‹ç»˜/${unit}/${name}.png`;
};
```

---

### 5. æ ·å¼ä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰

#### 5.1 CSS å˜é‡æå–

**å»ºè®®åœ¨ `<style>` é¡¶éƒ¨æ·»åŠ ï¼š**
```scss
:root {
  // ä¸»é¢˜è‰²
  --color-primary: #e91e63;
  --color-secondary: #9c27b0;
  --color-accent: #f48fb1;
  
  // é—´è·
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-md: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;
  
  // åœ†è§’
  --radius-sm: 8px;
  --radius-md: 12px;
  --radius-lg: 16px;
  
  // è¿‡æ¸¡
  --transition-fast: 0.15s ease;
  --transition-normal: 0.3s ease;
  --transition-slow: 0.5s ease;
  
  // é˜´å½±
  --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
  --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.2);
}
```

**ä½¿ç”¨ï¼š**
```scss
.button {
  background: var(--color-primary);
  padding: var(--spacing-md);
  border-radius: var(--radius-md);
  transition: all var(--transition-normal);
  box-shadow: var(--shadow-sm);
}
```

---

#### 5.2 SCSS Mixins

**å»ºè®®åˆ›å»ºï¼š** `src/å¶åƒå¤§å¸ˆé—ªè€€è‰²å½©/styles/_mixins.scss`
```scss
@mixin glass-card($opacity: 0.85) {
  background: rgba(255, 255, 255, $opacity);
  backdrop-filter: blur(12px);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
}

@mixin hover-scale($scale: 1.05) {
  transition: transform var(--transition-normal);
  
  &:hover {
    transform: scale($scale);
  }
}

@mixin responsive-font($min, $preferred, $max) {
  font-size: clamp($min, $preferred, $max);
}
```

**ä½¿ç”¨ï¼š**
```scss
.card {
  @include glass-card(0.9);
  @include hover-scale(1.03);
  @include responsive-font(14px, 2vw, 18px);
}
```

---

## ğŸ” ä»£ç å®¡æŸ¥å‘ç°

### âœ… ä¼˜ç‚¹

1. **ç»“æ„æ¸…æ™°**
   - Templateã€Scriptã€Style åˆ†ç¦»è‰¯å¥½
   - æ³¨é‡Šå®Œå–„
   - å‘½åè§„èŒƒ

2. **ç±»å‹å®‰å…¨**
   - ä½¿ç”¨ TypeScript
   - å®šä¹‰äº†æ¸…æ™°çš„æ¥å£ï¼ˆSongã€Characterï¼‰
   - computed ç±»å‹æ¨å¯¼æ­£ç¡®

3. **å“åº”å¼è®¾è®¡**
   - ä½¿ç”¨ clamp() è‡ªé€‚åº”
   - ç»ç’ƒæ€è®¾è®¡ç¾è§‚
   - åŠ¨ç”»æµç•…

4. **æ¨¡å—åŒ–**
   - `music-player.ts` å·²æˆåŠŸåˆ†ç¦»
   - `songs.ts` æ•°æ®ç‹¬ç«‹ç®¡ç†
   - èŒè´£æ¸…æ™°

### âš ï¸ éœ€æ³¨æ„

1. **å›¾ç‰‡åŠ è½½**
   - ç¼ºå°‘å ä½å›¾
   - æ— åŠ è½½çŠ¶æ€æŒ‡ç¤º
   - é”™è¯¯å¤„ç†å·²æ·»åŠ ï¼ˆä»Šæ—¥å®Œæˆï¼‰

2. **é”™è¯¯å¤„ç†**
   - éƒ¨åˆ† try-catch æœªç»†åŒ–é”™è¯¯ç±»å‹
   - å»ºè®®æ·»åŠ å…¨å±€é”™è¯¯è¾¹ç•Œ

3. **æµè§ˆå™¨å…¼å®¹æ€§**
   - `backdrop-filter` éœ€è¦å‰ç¼€
   - `aspect-ratio` æ—§æµè§ˆå™¨ä¸æ”¯æŒ
   - å»ºè®®æ·»åŠ  PostCSS Autoprefixer

---

## ğŸ“ æ€»ç»“ä¸å»ºè®®

### çŸ­æœŸï¼ˆæœ¬å‘¨ï¼‰
âœ… **ä¿æŒç°çŠ¶**
- ä»£ç è´¨é‡è‰¯å¥½ï¼Œæ— éœ€ç«‹å³é‡æ„
- ä¸“æ³¨äºåŠŸèƒ½å¼€å‘å’Œèµ„æºæ”¶é›†

### ä¸­æœŸï¼ˆä¸‹å‘¨ï¼‰
ğŸ”„ **å°å¹…ä¼˜åŒ–**
- æå–å¸¸é‡å’Œå·¥å…·å‡½æ•°
- æ·»åŠ å›¾ç‰‡æ‡’åŠ è½½
- å®Œå–„é”™è¯¯å¤„ç†

### é•¿æœŸï¼ˆç¬¬äºŒé˜¶æ®µï¼‰
ğŸ”¨ **ç»„ä»¶æ‹†åˆ†**
- åŠŸèƒ½ç¨³å®šåå†è¿›è¡Œ
- é‡‡ç”¨æ–¹æ¡ˆ A çš„æ‹†åˆ†æ–¹å¼
- å¼•å…¥çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰

---

## ğŸ› ï¸ ç«‹å³å¯æ‰§è¡Œçš„å°ä¼˜åŒ–

### 1. æ·»åŠ  PostCSS é…ç½®
```bash
pnpm add -D autoprefixer
```

åˆ›å»º `postcss.config.js`ï¼š
```javascript
module.exports = {
  plugins: {
    autoprefixer: {},
  },
};
```

### 2. æ·»åŠ å›¾ç‰‡æ‡’åŠ è½½
åœ¨æ‰€æœ‰ `<img>` æ ‡ç­¾æ·»åŠ  `loading="lazy"`

### 3. æ·»åŠ å¸¸é‡æ–‡ä»¶
åˆ›å»º `constants.ts` æå–é­”æœ¯æ•°å­—å’Œå­—ç¬¦ä¸²

---

**æœ€ç»ˆå»ºè®®ï¼šå½“å‰ä»£ç è´¨é‡ä¼˜ç§€ï¼Œæš‚ä¸éœ€è¦å¤§è§„æ¨¡é‡æ„ã€‚ä¸“æ³¨äºåŠŸèƒ½å¼€å‘ï¼Œç­‰é¡¹ç›®ç¨³å®šåå†ä¼˜åŒ–ã€‚**



